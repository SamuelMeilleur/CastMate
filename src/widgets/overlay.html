<html>

<head>
	<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
	<script src="https://unpkg.com/riot@4/riot+compiler.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/yamljs/0.3.0/yaml.min.js" integrity="sha512-f/K0Q5lZ1SrdNdjc2BO2I5kTx8E5Uw1EU3PhSUB9fYPohap5rPWEmQRCjtpDxNmQB4/+MMI/Cf+nvh1VSiwrTA==" crossorigin="anonymous"></script>
	<script src="/widgets/js/overlay-bridge.js"></script>
	<script>

		const urlParams = new URLSearchParams(window.location.search);
		const overlayName = urlParams.get('overlay');

		let overlayData = null;

		$.ajax({
			url: `/overlays/${overlayName}.yaml`,
			async: false,
		}).done((data) =>
		{
			overlayData = YAML.parse(data);
			console.log(overlayData);

			$(document).ready(function ()
			{
				for (let widget of overlayData)
				{
					let name = widget.name;

					let frame = $("<iframe></iframe>").addClass('widget-container').css({
						position: 'absolute',
						left: widget.position.x,
						top: widget.position.y,
						width: widget.position.width,
						height: widget.position.height
					}).attr('src', `/widgets/widget.html?widget=${name}`)
					$(document.body).append(frame)
				}
			});
		});


	</script>
</head>

<body>
</body>

</html>